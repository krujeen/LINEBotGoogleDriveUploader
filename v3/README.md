# ЁЯУд LINE Bot Google Drive Uploader (v3)

р╣Вр╕Ыр╕гр╣Ар╕Ир╕Бр╕Хр╣Мр╕Щр╕╡р╣Йр╣Ар╕Ыр╣Зр╕Щр╕гр╕░р╕Ър╕Ър╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╣Др╕Яр╕ер╣Мр╕Ьр╣Ир╕▓р╕Щ **LINE Bot** р╣Вр╕Фр╕вр╣Гр╕Кр╣Й **Google Apps Script** р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Бр╕▒р╕Ъ **Google Drive** р╕Юр╕гр╣Йр╕нр╕бр╕лр╕Щр╣Йр╕▓р╣Ар╕зр╣Зр╕Ър╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Др╕Яр╕ер╣М р╣Бр╕ер╕░р╕Др╕зр╕▓р╕бр╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Гр╕лр╕бр╣Ир╣Гр╕Щр╣Ар╕зр╕нр╕гр╣Мр╕Кр╕▒р╕Щр╕Щр╕╡р╣Й:

* тЬЕ р╣Ар╕Юр╕┤р╣Ир╕бр╕гр╕░р╕Ър╕Ър╕гр╕▒р╕Бр╕йр╕▓р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в: р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щр╕Бр╣Ир╕нр╕Щ **р╕ер╕Ъ/р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Кр╕╖р╣Ир╕н** р╣Др╕Яр╕ер╣Мр╕лр╕гр╕╖р╕нр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М

---

## ЁЯЪА р╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣М

* р╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╣Др╕Яр╕ер╣Мр╕Ир╕▓р╕Бр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й LINE Bot р╣Др╕Ыр╕вр╕▒р╕З Google Drive
* р╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Ф **р╣Др╕Яр╕ер╣М** р╣Бр╕ер╕░ **р╕гр╕╣р╕Ыр╕ар╕▓р╕Ю**
* р╕Ир╕▒р╕Фр╣Ар╕Бр╣Зр╕Ър╣Др╕Яр╕ер╣Мр╣Бр╕вр╕Бр╕лр╕бр╕зр╕Фр╕лр╕бр╕╣р╣Ир╕Хр╕▓р╕бр╕Чр╕╡р╣Ир╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕кр╣Ир╕Зр╕бр╕▓
* р╕кр╣Ир╕Зр╕ер╕┤р╕Зр╕Бр╣Мр╕Бр╕ер╕▒р╕Ър╕лр╕▓р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Ьр╣Ир╕▓р╕Щ **LINE Messaging API**
* Web Interface р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Др╕Яр╕ер╣М (р╕Фр╕╣, р╕ер╕Ъ, р╣Бр╕Бр╣Йр╕Кр╕╖р╣Ир╕н, р╕вр╣Йр╕▓р╕в, р╣Бр╕Кр╕гр╣М)
* тЬЕ **р╕гр╕░р╕Ър╕Ър╕вр╕╖р╕Щр╕вр╕▒р╕Щр╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щр╕Бр╣Ир╕нр╕Щр╕ер╕Ър╕лр╕гр╕╖р╕нр╣Бр╕Бр╣Йр╣Др╕Вр╣Др╕Яр╕ер╣М**

---

## ЁЯЫая╕П р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### 1. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Google Apps Script

1. р╣Ар╕Вр╣Йр╕▓р╣Др╕Ыр╕Чр╕╡р╣И [Google Apps Script](https://script.google.com/)

2. р╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╕Бр╕Хр╣Мр╣Гр╕лр╕бр╣И

3. р╕кр╕гр╣Йр╕▓р╕З 2 р╣Др╕Яр╕ер╣М:

   * `code.gs` тЖТ р╕зр╕▓р╕Зр╣Вр╕Др╣Йр╕Фр╕Ир╕▓р╕Б `code.gs`
   * `index.html` тЖТ р╕зр╕▓р╕Зр╣Вр╕Др╣Йр╕Фр╕Ир╕▓р╕Б `index.html`

4. р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ API р╕Чр╕╡р╣Ир╕Ир╕│р╣Ар╕Ыр╣Зр╕Щ:

   * **Google Drive API**
   * **LINE Messaging API** (р╕Ьр╣Ир╕▓р╕Щ LINE Developer Console)

### 2. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ LINE Developer

1. р╣Др╕Ыр╕Чр╕╡р╣И [LINE Developers Console](https://developers.line.biz/)
2. р╕кр╕гр╣Йр╕▓р╕З Channel р╣Гр╕лр╕бр╣И
3. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Webhook URL р╣Гр╕лр╣Йр╕Кр╕╡р╣Йр╣Др╕Ыр╕вр╕▒р╕З Web App URL р╕Ир╕▓р╕Бр╕Бр╕▓р╕г Deploy Apps Script
4. р╕Др╕▒р╕Фр╕ер╕нр╕Б `Channel Access Token` р╣Бр╕ер╕░ `Channel Secret` р╕бр╕▓р╣Гр╕кр╣Ир╣Гр╕Щ `code.gs`

### 3. Deploy Web App

* р╕Др╕ер╕┤р╕Б `Deploy` > `Manage deployments` > `New deployment`
* р╣Ар╕ер╕╖р╕нр╕Бр╕Ыр╕гр╕░р╣Ар╕ар╕Ч `Web App`

  * Execute as: **Me**
  * Who has access: **Anyone**
* р╕Др╕ер╕┤р╕Б Deploy р╣Бр╕ер╣Йр╕зр╕Др╕▒р╕Фр╕ер╕нр╕Б URL р╣Др╕Ыр╣Гр╕Кр╣Йр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Webhook

---

## ЁЯФР р╕гр╕░р╕Ър╕Ър╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щ (NEW!)

* р╕Бр╣Ир╕нр╕Щр╕Ир╕░ **р╕ер╕Ъ/р╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Кр╕╖р╣Ир╕нр╣Др╕Яр╕ер╣Мр╕лр╕гр╕╖р╕нр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣М** р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕Хр╣Йр╕нр╕Зр╕Бр╕гр╕нр╕Бр╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щ
* р╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щр╕Цр╕╣р╕Бр╕Бр╕│р╕лр╕Щр╕Фр╣Др╕зр╣Йр╣Гр╕Щ `code.gs` р╕Чр╕╡р╣Ир╕Хр╕▒р╕зр╣Бр╕Ыр╕г:

  ```js
  const ADMIN_PASSWORD = 'yourpassword';
  ```
* р╕Эр╕▒р╣Ир╕З Web (`index.html`) р╕Ир╕░р╕бр╕╡ `prompt()` р╕Вр╕нр╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щр╣Ар╕бр╕╖р╣Ир╕нр╕бр╕╡р╕Бр╕▓р╕гр╕Фр╕│р╣Ар╕Щр╕┤р╕Щр╕Бр╕▓р╕гр╕кр╕│р╕Др╕▒р╕Н

---

## ЁЯз╛ р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М

```
v2/
тФЬтФАтФА code.gs         # р╣Вр╕Др╣Йр╕Фр╕лр╕ер╕▒р╕Бр╕Чр╕╡р╣Ир╣Гр╕Кр╣Йр╕Ир╕▒р╕Фр╕Бр╕▓р╕г LINE Webhook р╣Бр╕ер╕░ Web Interface
тФФтФАтФА index.html      # р╕кр╣Ир╕зр╕Щр╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Ьр╕╣р╣Йр╣Гр╕Кр╣Йр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Фр╕╣р╣Бр╕ер╕░р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Др╕Яр╕ер╣М
```

---

## ЁЯФз р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╣Бр╕Бр╣Йр╣Др╕В

### ЁЯФ╣ code.gs

р╕Ър╕гр╕гр╕Чр╕▒р╕Фр╕Чр╕╡р╣И 3-5:

```js
const LINE_CHANNEL_ACCESS_TOKEN = 'YOUR_CHANNEL_ACCESS_TOKEN';
const LINE_CHANNEL_SECRET = 'YOUR_CHANNEL_SECRET';
const FOLDER_ID = 'YOUR_GOOGLE_DRIVE_FOLDER_ID';
```

р╕Ър╕гр╕гр╕Чр╕▒р╕Фр╕Чр╕╡р╣И \~6:

```js
const ADMIN_PASSWORD = 'yourpassword';  // тЬЕ р╣Ар╕Юр╕┤р╣Ир╕бр╕гр╕лр╕▒р╕кр╕Ьр╣Ир╕▓р╕Щр╕Хр╕гр╕Зр╕Щр╕╡р╣Й
```

---

### ЁЯФ╣ index.html

р╕Ър╕гр╕гр╕Чр╕▒р╕Фр╕Чр╕╡р╣И \~604:

```js
const ROOT_FOLDER_ID = 'YOUR_GOOGLE_DRIVE_FOLDER_ID';
```

---

## ЁЯУМ р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕

* р╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕лр╕ер╕▒р╕Бр╕Др╕зр╕гр╕Бр╕│р╕лр╕Щр╕Фр╕кр╕┤р╕Чр╕Шр╕┤р╣Мр╣Гр╕лр╣Йр╕Ьр╕╣р╣Йр╕Чр╕╡р╣Ир╕бр╕╡р╕ер╕┤р╕Зр╕Бр╣Мр╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Фр╕╣р╣Др╕Фр╣Й
* р╕Чр╕Фр╕кр╕нр╕Ъ Webhook р╕Ьр╣Ир╕▓р╕Щ LINE Developer Console р╕лр╕гр╕╖р╕н Postman
* р╕гр╕░р╕Ър╕Ър╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Юр╕▒р╕Тр╕Щр╕▓р╣Ар╕Юр╕┤р╣Ир╕б р╣Ар╕Кр╣Ир╕Щ:

  * р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕Яр╕ер╣Мр╕ер╕З Google Sheet
  * р╕кр╕Цр╕┤р╕Хр╕┤р╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Ф
  * р╕гр╕░р╕Ър╕Ър╕ер╣Зр╕нр╕Бр╕нр╕┤р╕Щ

---

## ЁЯЩП р╕Вр╕нр╕Ър╕Др╕╕р╕У

р╣Вр╕Ыр╕гр╣Ар╕Ир╕Бр╕Хр╣Мр╕Щр╕╡р╣Йр╕Юр╕▒р╕Тр╕Щр╕▓р╣Вр╕Фр╕в [@krujeen](https://github.com/krujeen) р╣Ар╕Юр╕╖р╣Ир╕нр╕нр╕│р╕Щр╕зр╕вр╕Др╕зр╕▓р╕бр╕кр╕░р╕Фр╕зр╕Бр╣Бр╕Бр╣Ир╕Ьр╕╣р╣Йр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╣Бр╕ер╕░р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Др╕Яр╕ер╣Мр╕Ьр╣Ир╕▓р╕Щ LINE Bot р╣Бр╕ер╕░ Google Drive р╕нр╕вр╣Ир╕▓р╕Зр╕Зр╣Ир╕▓р╕вр╕Фр╕▓р╕в

---
